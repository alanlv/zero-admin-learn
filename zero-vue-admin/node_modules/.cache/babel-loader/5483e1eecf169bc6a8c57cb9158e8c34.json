{"remainingRequest":"/home/nyx/go/src/zero-admin-learn/zero-vue-admin/node_modules/babel-loader/lib/index.js!/home/nyx/go/src/zero-admin-learn/zero-vue-admin/node_modules/eslint-loader/index.js??ref--13-0!/home/nyx/go/src/zero-admin-learn/zero-vue-admin/src/store/modules/user.js","dependencies":[{"path":"/home/nyx/go/src/zero-admin-learn/zero-vue-admin/src/store/modules/user.js","mtime":1663772681933},{"path":"/home/nyx/go/src/zero-admin-learn/zero-vue-admin/babel.config.js","mtime":1663772681925},{"path":"/home/nyx/go/src/zero-admin-learn/zero-vue-admin/node_modules/cache-loader/dist/cjs.js","mtime":1663772752666},{"path":"/home/nyx/go/src/zero-admin-learn/zero-vue-admin/node_modules/babel-loader/lib/index.js","mtime":1663772755418},{"path":"/home/nyx/go/src/zero-admin-learn/zero-vue-admin/node_modules/eslint-loader/index.js","mtime":1663772753018}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0IGFzIF9sb2dvdXQsIGdldEluZm8gYXMgX2dldEluZm8gfSBmcm9tICdAL2FwaS9zeXN0ZW0vdXNlci91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgeyB0cmVlIH0gZnJvbSAiQC91dGlscy91dGlscyI7Cgp2YXIgZ2V0RGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gZ2V0RGVmYXVsdFN0YXRlKCkgewogIHJldHVybiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgbWVudXM6IFtdCiAgfTsKfTsKCnZhciBzdGF0ZSA9IGdldERlZmF1bHRTdGF0ZSgpOwp2YXIgbXV0YXRpb25zID0gewogIFJFU0VUX1NUQVRFOiBmdW5jdGlvbiBSRVNFVF9TVEFURShzdGF0ZSkgewogICAgT2JqZWN0LmFzc2lnbihzdGF0ZSwgZ2V0RGVmYXVsdFN0YXRlKCkpOwogIH0sCiAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogIH0sCiAgU0VUX05BTUU6IGZ1bmN0aW9uIFNFVF9OQU1FKHN0YXRlLCBuYW1lKSB7CiAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICB9LAogIFNFVF9BVkFUQVI6IGZ1bmN0aW9uIFNFVF9BVkFUQVIoc3RhdGUsIGF2YXRhcikgewogICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogIH0sCiAgU0VUX01FTlVTOiBmdW5jdGlvbiBTRVRfTUVOVVMoc3RhdGUsIGF2YXRhcikgewogICAgc3RhdGUubWVudXMgPSBhdmF0YXI7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICAvLyB1c2VyIGxvZ2lubG9nCiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKF9yZWYsIHVzZXJJbmZvKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICB2YXIgdXNlcm5hbWUgPSB1c2VySW5mby51c2VybmFtZSwKICAgICAgICBwYXNzd29yZCA9IHVzZXJJbmZvLnBhc3N3b3JkOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ2luKHsKICAgICAgICB1c2VyTmFtZTogdXNlcm5hbWUudHJpbSgpLAogICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciB0b2tlbiA9IHJlc3BvbnNlLnRva2VuOwogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgIkJlYXJlciAiICsgdG9rZW4pOwogICAgICAgIHNldFRva2VuKCJCZWFyZXIgIiArIHRva2VuKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2dldEluZm8oKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBuYW1lID0gcmVzcG9uc2UubmFtZSwKICAgICAgICAgICAgYXZhdGFyID0gcmVzcG9uc2UuYXZhdGFyLAogICAgICAgICAgICBtZW51VHJlZVZ1ZSA9IHJlc3BvbnNlLm1lbnVUcmVlVnVlOyAvLyBpZiAoIWRhdGEpIHsKICAgICAgICAvLyAgIHJldHVybiByZWplY3QoJ1ZlcmlmaWNhdGlvbiBmYWlsZWQsIHBsZWFzZSBMb2dpbiBhZ2Fpbi4nKQogICAgICAgIC8vIH0KICAgICAgICAvLyBjb25zdCB7IG5hbWUsIGF2YXRhcixyZXNvdXJjZXMgfSA9IGRhdGEKCiAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIG5hbWUpOwogICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIGF2YXRhcik7IC8vIHJlc291cmNlcy5wdXNoKHsKICAgICAgICAvLyAgIHBhdGg6ICcvNDA0JywKICAgICAgICAvLyAgIGNvbXBvbmVudDogJzQwNCcsCiAgICAgICAgLy8gICBoaWRkZW46IHRydWUKICAgICAgICAvLyB9LCB7CiAgICAgICAgLy8gICBwYXRoOiAnKicsCiAgICAgICAgLy8gICByZWRpcmVjdDogJy80MDQnLAogICAgICAgIC8vICAgaGlkZGVuOiB0cnVlCiAgICAgICAgLy8gfSkKCiAgICAgICAgY29tbWl0KCdTRVRfTUVOVVMnLCB0cmVlKG1lbnVUcmVlVnVlLCAwLCAncGFyZW50SWQnKSk7CiAgICAgICAgcmVzb2x2ZShtZW51VHJlZVZ1ZSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyB1c2VyIGxvZ291dAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICAgIHN0YXRlID0gX3JlZjMuc3RhdGU7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9nb3V0KHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CgogICAgICAgIHJlc2V0Um91dGVyKCk7CiAgICAgICAgY29tbWl0KCdSRVNFVF9TVEFURScpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHJlbW92ZSB0b2tlbgogIHJlc2V0VG9rZW46IGZ1bmN0aW9uIHJlc2V0VG9rZW4oX3JlZjQpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAoKICAgICAgY29tbWl0KCdSRVNFVF9TVEFURScpOwogICAgICByZXNvbHZlKCk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBzdGF0ZSwKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zCn07"},{"version":3,"names":["login","logout","getInfo","getToken","setToken","removeToken","resetRouter","tree","getDefaultState","token","name","menus","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","avatar","SET_MENUS","actions","userInfo","commit","username","password","Promise","resolve","reject","userName","trim","then","response","catch","error","menuTreeVue","resetToken","namespaced"],"sources":["/home/nyx/go/src/zero-admin-learn/zero-vue-admin/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/system/user/user'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\nimport {tree} from \"@/utils/utils\";\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    menus: []\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  },\n  SET_MENUS: (state, avatar) => {\n    state.menus = avatar\n  }\n}\n\nconst actions = {\n  // user loginlog\n  login({ commit }, userInfo) {\n    const { username, password } = userInfo\n    return new Promise((resolve, reject) => {\n      login({ userName: username.trim(), password: password }).then(response => {\n        const { token } = response\n        commit('SET_TOKEN', \"Bearer \" + token)\n        setToken(\"Bearer \" + token)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // get user info\n  getInfo({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      getInfo().then(response => {\n        const { name, avatar,menuTreeVue } = response\n\n        // if (!data) {\n        //   return reject('Verification failed, please Login again.')\n        // }\n\n        // const { name, avatar,resources } = data\n\n        commit('SET_NAME', name)\n        commit('SET_AVATAR', avatar)\n\n        // resources.push({\n        //   path: '/404',\n        //   component: '404',\n        //   hidden: true\n        // }, {\n        //   path: '*',\n        //   redirect: '/404',\n        //   hidden: true\n        // })\n\n        commit('SET_MENUS', tree(menuTreeVue,0,'parentId'))\n        resolve(menuTreeVue)\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // user logout\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken() // must remove  token  first\n        resetRouter()\n        commit('RESET_STATE')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken() // must remove  token  first\n      commit('RESET_STATE')\n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"],"mappings":"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"}]}